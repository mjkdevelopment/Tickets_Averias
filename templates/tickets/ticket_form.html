{% extends "base.html" %}
{% block title %}Nuevo ticket{% endblock %}

{% block content %}
<h2>Nuevo ticket</h2>
<hr>

<form method="post" enctype="multipart/form-data">
    {% csrf_token %}

    <!-- LOCAL con autocompletado -->
    <div class="mb-3">
        <label for="{{ form.local.id_for_label }}" class="form-label">Local *</label>
        {{ form.local }}
        {{ form.local.errors }}

        <!-- üîΩ Sugerencias de locales existentes -->
        <datalist id="locales-datalist">
            {% for nombre in locales_sugeridos %}
                <option value="{{ nombre }}"></option>
            {% endfor %}
        </datalist>

        <small class="form-text text-muted">
            Escribe el c√≥digo/nombre del local. Si ya existe, podr√°s seleccionarlo;
            si no existe, se crear√° autom√°ticamente.
        </small>
    </div>

    <div class="mb-3">
        <label for="{{ form.categoria.id_for_label }}" class="form-label">Categor√≠a *</label>
        {{ form.categoria }}
        {{ form.categoria.errors }}
        <small class="form-text text-muted">
            Tipo de aver√≠a (PC, Internet, El√©ctrica, etc.).
        </small>
    </div>

    <div class="mb-3">
        <label for="{{ form.descripcion.id_for_label }}" class="form-label">
            Comentario / descripci√≥n de la aver√≠a *
        </label>
        {{ form.descripcion }}
        {{ form.descripcion.errors }}
        <small class="form-text text-muted">
            Ejemplo: ‚Äúteclado no escribe‚Äù, ‚Äúno tiene luz el√©ctrica‚Äù,
            ‚Äútiene energ√≠a pero el letrero no enciende‚Äù, etc.
        </small>
    </div>

    <div class="mb-3">
        <label for="{{ form.prioridad.id_for_label }}" class="form-label">Prioridad *</label>
        {{ form.prioridad }}
        {{ form.prioridad.errors }}
    </div>

    <div class="mb-3">
        <label for="{{ form.asignado_a.id_for_label }}" class="form-label">
            T√©cnico asignado (opcional)
        </label>
        {{ form.asignado_a }}
        {{ form.asignado_a.errors }}
        <small class="form-text text-muted">
            Si lo dejas vac√≠o, un administrador lo puede asignar luego.
        </small>
    </div>

    <div class="d-flex justify-content-between">
        <a href="{% url 'tickets_lista' %}" class="btn btn-secondary">
            Cancelar
        </a>
        <button type="submit" class="btn btn-primary">
            Crear ticket
        </button>
    </div>
</form>
{% endblock %}
